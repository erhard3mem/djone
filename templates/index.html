<!DOCTYPE html>
<html>
<head>
    <title>DJone - a python disc jockey</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;1,400&display=swap');
       /* body {
            font-family: Roboto;
        }
        h1 {
            padding:20px;
            background-color: aquamarine;
            margin:0;
        }
        form {
            padding:20px;
            background-color:azure;
        }
        #data-container {            
            padding:20px;
            background-color: aqua;
        }
	#loading {
	  display:none;
	}*/
        /* Reset default styling */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: Arial, sans-serif;
}

body {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background-color: #f3f4f6;
    color: #333;
    padding: 20px;
}

/* Main container styling */
h1 {
    font-size: 2.5rem;
    color: #333;
    text-align: center;
    margin-bottom: 1rem;
    padding:50px;
}

/* Form styling */
form {
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 400px;
    background-color: #ffffff;
    padding: 1.5rem;
    border-radius: 8px;
    box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);
}

form label {
    font-size: 0.9rem;
    color: #555;
    margin-top: 0.75rem;
    margin-bottom: 0.25rem;
}

form input[type="text"],
form input[type="submit"] {
    padding: 0.75rem;
    font-size: 1rem;
    border-radius: 4px;
    border: 1px solid #ddd;
    width: 100%;
    outline: none;
    transition: border-color 0.3s;
}

form input[type="text"]:focus {
    border-color: #4a90e2;
}

form input[type="submit"] {
    background-color: #4a90e2;
    color: white;
    border: none;
    font-weight: bold;
    cursor: pointer;
    margin-top: 1rem;
    transition: background-color 0.3s;
}

form input[type="submit"]:hover {
    background-color: #357ABD;
}

/* Loading message */
#loading {
    text-align: center;
    margin-top: 1rem;
    color: #888;
    font-style: italic;
    display: none; /* Initially hidden */
    padding:50px;
}

/* Data container styling */
#data-container {
    width: 100%;
    max-width: 600px;
    margin-top: 2rem;
    margin:50px;
}

#myList {
    list-style-type: none;
    padding: 0;
}

#myList li {
    background-color: #ffffff;
    border: 1px solid #ddd;
    border-radius: 8px;
    margin-bottom: 0.5rem;
    padding: 0.75rem;
    transition: transform 0.2s ease;
}

#myList li a {
    color: #4a90e2;
    text-decoration: none;
    font-weight: bold;
}

#myList li a:hover {
    text-decoration: underline;
}


    </style>
    <meta name="csrf-token" content="{{ csrf_token() }}">
</head>
<body>

    <!--<div>
        <button id="login_button">Mit Google anmelden</button>
        <pre id="content"></pre>

        <script>
            document.getElementById('login_button').onclick = function() {
                window.location.href = '/login'; // Leite zur Flask-Login-Route weiter
            };

            async function fetchSubscriptions() {
                const response = await fetch('/api/subscriptions');
                const data = await response.json();
                document.getElementById('content').innerText = JSON.stringify(data, null, 2);
            }
        </script>
    </div>-->





    <h1>DJone</h1>
    
    <form method="POST" action="/">
        {{ form.csrf_token }}
        {{ form.name0.label }} {{ form.name0 }}<br />
        {{ form.name1.label }} {{ form.name1 }}<br />
        {{ form.name2.label }} {{ form.name2 }}<br />
        {{ form.name3.label }} {{ form.name3 }}<br />
        {{ form.name4.label }} {{ form.name4 }}<br /><br />
        {{ form.submit }}
    </form>
    
    <div id="loading">
        ...loading...
    </div>

    <div id="data-container">
        <ol id="myList"></ol>
    </div>

    <script>
        var csrftoken = $('meta[name=csrf-token]').attr('content')

        $.ajaxSetup({
            beforeSend: function(xhr, settings) {
                if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type)) {
                    xhr.setRequestHeader("X-CSRFToken", csrftoken)
                }
            }
        })

       $(document).ready(function() {
            $('form').submit(function(e) {
                e.preventDefault();  // Prevent form submission
                $('#loading').html("...loading... <br />please be patient, this may take a minute");
                $('#loading').show();
                $("#data-container #myList").html("");

                // Collect form data
                var formData = {
                    name0: $('#name0').val(),
                    name1: $('#name1').val(),
                    name2: $('#name2').val(),
                    name3: $('#name3').val(),
                    name4: $('#name4').val(),
                };

                $.ajax({
                    url: '/',
                    type: 'POST',
                    data: formData,
                    dataType: 'json',
                    success: function(response) {
                        console.log(response)                        
			            $('#loading').hide();
                        for(s in response) {
                            $("#myList").append($('<li>').html("<a target=\"_blank\" href='https://www.youtube.com/results?search_query="+response[s]+"'>"+response[s]+"</a>"));
                         //   $("#myList").append($('<li>').html("<a target=\"_blank\" href='https://www.youtube.com/playlist?list="+response[s]+"'>Your DJone YouTube playlist</a>"));
                        }            
                    },
                   error: function(xhr, status, error) {
                    	$("#loading").html("failed: error");
                        $("#loading").show();
                        console.log(error);
                   }
                });
            });
        });
    </script>
</body>
</html>
